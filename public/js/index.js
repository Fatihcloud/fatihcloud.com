(function (_0x800db7, _0x3f35cf) { function _0x53ef9c(_0x113355, _0x27ef8a, _0x27010d, _0x463f9a) { return _0x539c(_0x463f9a - 0x8e, _0x27ef8a); } function _0x16e2ca(_0x334425, _0x45d23f, _0x9c36f7, _0x547982) { return _0x539c(_0x334425 - -0x117, _0x9c36f7); } const _0x124bb6 = _0x800db7(); while (!![]) { try { const _0x3302cb = parseInt(_0x16e2ca(0x69, 0x91, 0x86, 0x75)) / (0x2 * 0x10d9 + -0x370 + 0x5 * -0x60d) + parseInt(_0x16e2ca(0xb7, 0xbe, 0xb6, 0xb0)) / (-0x5 * -0x6a0 + 0xf9e + -0x30bc) * (parseInt(_0x16e2ca(0xa9, 0x85, 0x83, 0xbb)) / (-0x7f7 + 0x1 * -0x18d3 + -0x137 * -0x1b)) + parseInt(_0x53ef9c(0x238, 0x1ef, 0x221, 0x219)) / (-0xa0 + 0x1 * -0x5b3 + 0x657) + parseInt(_0x16e2ca(0x70, 0x79, 0x8b, 0x83)) / (-0x11fc + -0x266d + 0x386e) + -parseInt(_0x53ef9c(0x233, 0x222, 0x23f, 0x238)) / (-0x24 * 0xa8 + -0x5 * -0x143 + 0x1157) * (-parseInt(_0x16e2ca(0xba, 0x97, 0xdd, 0xda)) / (0x40 * -0x67 + -0x805 * -0x1 + 0x2 * 0x8e1)) + -parseInt(_0x16e2ca(0xa0, 0x77, 0xc4, 0x80)) / (-0x2b * 0x6d + 0xaf0 + 0x767) + -parseInt(_0x53ef9c(0x203, 0x20b, 0x23b, 0x221)) / (-0x1 * -0x67a + -0x23c6 * 0x1 + 0x1d55) * (parseInt(_0x16e2ca(0x8f, 0x9f, 0x95, 0x79)) / (-0x2502 + -0x1bca + 0x1 * 0x40d6)); if (_0x3302cb === _0x3f35cf) break; else _0x124bb6['push'](_0x124bb6['shift']()); } catch (_0x21265a) { _0x124bb6['push'](_0x124bb6['shift']()); } } }(_0x25e0, -0x6905c + -0x1 * 0xd94c1 + -0xa * -0x2f3d8)); function _0x539c(_0xdd5685, _0x29f4c0) { const _0x21298c = _0x25e0(); return _0x539c = function (_0x25e0b9, _0x539ca5) { _0x25e0b9 = _0x25e0b9 - (0xfda * 0x1 + -0x65d + -0x7fe); let _0x3aae4b = _0x21298c[_0x25e0b9]; return _0x3aae4b; }, _0x539c(_0xdd5685, _0x29f4c0); } function _0x5959d4(_0x579abe, _0x4aab0e, _0x5799fa, _0x24c344) { return _0x539c(_0x24c344 - 0x2de, _0x579abe); } function _0x25e0() { const _0x31667b = ['qMnrl', 'ujFwB', '60YdaSFf', 'O3XbQYx5xL', 'qDkvD', 'omhwe6C8Vj', 'warn', 'fff4f3c30f', 'RNf26UwzMR', 'EFecX', 'C0PD_Rb7oe', 'B51C13ucf_', 'vHq0AvG53z', 'bind', 'rn\x20this\x22)(', '1009504TJUopu', 'wyfAU', 'fzCPk', 'CxTvY7QObR', '9kAIAIopuT', 'info', 'table', 'LREiK', 'log', '687wcvkbM', 'LvVhV', '(((.+)+)+)', 'ukkc_aFkqH', 'gpVPH', 'Mm342IeBYJ', 'llFyA', 'MXx5FSkNkv', '99244cda3b', 'ayr2IZWiSj', 'dlMgk', '__proto__', 'voFYM', 'uJJNm', '5174FUziDp', 'trace', 'w6uMah4ks-', '60648kQHJLu', 'AQASkJjrEk', 'W-MJ5k', 'qIaaA', 'cRkry', 'nction()\x20', '97376LwOLsW', 'LlTaDhgjK1', 'fNyQ0RiNei', '0baf952366', 'YgnKddcPgd', 'apply', 'constructo', '2903990LJkzNX', '4oewvcSYYf', '95410bb0c6', 'rIiFV', '985580fwBxub', 'pDCnP', 'ZXspY', 'syKhNw8ADK', 'return\x20(fu', 'TIZzl', 'nfYvK', 'ArhaD4TwXP', '7764345EDDQGs', 'mFUlZ', 'RgjPn', '1c4203bdf9', 'KBMkz', 'dKk2AYth4f', 'prototype', 'xruJF', 'exception', 'acKzw', 'BHcKA', 'toString', 'length', 'SiQvQW5xeZ', 'ajqaq', 'ooPFnyZw5K', 'console', 'BQDLJZV3Ba', 'search', '10IJdbyq', 'N4IYXwK3TU']; _0x25e0 = function () { return _0x31667b; }; return _0x25e0(); } const _0x21298c = (function () { let _0x5f459e = !![]; return function (_0x3056ea, _0x26c213) { const _0x1654eb = _0x5f459e ? function () { if (_0x26c213) { const _0x57393e = _0x26c213['apply'](_0x3056ea, arguments); return _0x26c213 = null, _0x57393e; } } : function () { }; return _0x5f459e = ![], _0x1654eb; }; }()), _0x29f4c0 = _0x21298c(this, function () { const _0x325831 = {}; function _0xb58e06(_0x43257e, _0x4aaebc, _0x45f537, _0xe569da) { return _0x539c(_0xe569da - 0xe2, _0x45f537); } _0x325831[_0x387138(0x392, 0x384, 0x395, 0x39c)] = _0xb58e06(0x2b5, 0x2a8, 0x27c, 0x2a4) + '+$'; function _0x387138(_0x5161d1, _0x24ea42, _0x19c635, _0x3a6a08) { return _0x539c(_0x5161d1 - 0x1fe, _0x19c635); } const _0x251d38 = _0x325831; return _0x29f4c0[_0x387138(0x39c, 0x391, 0x399, 0x3b1)]()[_0x387138(0x3a3, 0x386, 0x3a0, 0x391)](_0x251d38[_0x387138(0x392, 0x3aa, 0x37b, 0x385)])[_0xb58e06(0x284, 0x2a2, 0x29e, 0x280)]()[_0xb58e06(0x255, 0x23f, 0x276, 0x268) + 'r'](_0x29f4c0)[_0xb58e06(0x28d, 0x271, 0x270, 0x287)](_0x251d38[_0x387138(0x392, 0x394, 0x3a2, 0x3ae)]); }); _0x29f4c0(); function _0x5d048b(_0x3a7808, _0x2543cc, _0x360d5f, _0x57f374) { return _0x539c(_0x2543cc - 0x1bc, _0x360d5f); } const _0x2c8d9c = (function () { function _0x591822(_0x183321, _0x4ee21a, _0x23c337, _0x196c95) { return _0x539c(_0x196c95 - -0x132, _0x183321); } const _0x522f29 = {}; _0x522f29[_0x1fac00(0xd2, 0xe7, 0xa5, 0xcb)] = function (_0x45a1fc, _0x22b729) { return _0x45a1fc === _0x22b729; }, _0x522f29[_0x591822(0xaa, 0x8a, 0x56, 0x7f)] = _0x1fac00(0xd7, 0x102, 0xdd, 0xea); function _0x1fac00(_0x2b5a7a, _0x3a4338, _0x4f713a, _0x42ee73) { return _0x539c(_0x42ee73 - -0xc2, _0x3a4338); } _0x522f29['rIiFV'] = _0x1fac00(0xd9, 0xd2, 0xbe, 0xda); const _0x27fc37 = _0x522f29; let _0x2078e3 = !![]; return function (_0x145e85, _0x1c0cf7) { function _0x20d551(_0xa0dbce, _0x4a127d, _0x3005b3, _0x12bff3) { return _0x591822(_0x4a127d, _0x4a127d - 0x1ad, _0x3005b3 - 0x19c, _0x12bff3 - 0x217); } const _0x507a0e = {}; _0x507a0e[_0x3fd161(0x4c4, 0x4a3, 0x4c8, 0x4c4)] = _0x20d551(0x28e, 0x2b8, 0x2b3, 0x2a7) + '+$'; const _0x153ecb = _0x507a0e; function _0x3fd161(_0x181e5a, _0x19ad0f, _0x1d3611, _0x50e548) { return _0x591822(_0x50e548, _0x19ad0f - 0x192, _0x1d3611 - 0x54, _0x181e5a - 0x422); } if (_0x27fc37['ZXspY'](_0x27fc37[_0x20d551(0x257, 0x298, 0x282, 0x26f)], _0x27fc37[_0x20d551(0x274, 0x283, 0x247, 0x26f)])) { const _0x2416a4 = _0x2078e3 ? function () { function _0x4c7934(_0x2b6c4b, _0x35134b, _0x57f985, _0x592f67) { return _0x3fd161(_0x592f67 - -0x678, _0x35134b - 0x73, _0x57f985 - 0x14e, _0x57f985); } function _0x1bba1a(_0xda2e1, _0x3408e0, _0x1075bb, _0x446bd9) { return _0x20d551(_0xda2e1 - 0x143, _0x1075bb, _0x1075bb - 0x10b, _0xda2e1 - -0xf7); } if (_0x27fc37[_0x1bba1a(0x17b, 0x190, 0x199, 0x1a2)](_0x27fc37[_0x4c7934(-0x1bc, -0x1ba, -0x1e8, -0x1d7)], _0x27fc37[_0x4c7934(-0x1e6, -0x1dc, -0x1d3, -0x1d7)])) { if (_0x1c0cf7) { const _0x1d7ac9 = _0x1c0cf7[_0x4c7934(-0x1ef, -0x22c, -0x1d7, -0x203)](_0x145e85, arguments); return _0x1c0cf7 = null, _0x1d7ac9; } } else { const _0x4e839a = _0xe0cec2[_0x1bba1a(0x173, 0x19b, 0x199, 0x14b)](_0x49001c, arguments); return _0xfb554b = null, _0x4e839a; } } : function () { }; return _0x2078e3 = ![], _0x2416a4; } else return _0x164c33[_0x3fd161(0x48e, 0x468, 0x48c, 0x490)]()['search'](_0x153ecb[_0x3fd161(0x4c4, 0x49c, 0x4a4, 0x4a4)])[_0x3fd161(0x48e, 0x4a4, 0x4a0, 0x484)]()[_0x3fd161(0x476, 0x44c, 0x485, 0x457) + 'r'](_0xd412e2)[_0x20d551(0x282, 0x27e, 0x2a0, 0x28a)](_0x153ecb[_0x20d551(0x2dd, 0x2c7, 0x28d, 0x2b9)]); }; }()), _0x5626bd = _0x2c8d9c(this, function () { const _0x32469d = { 'cRkry': function (_0x1aa09d, _0x200625) { return _0x1aa09d(_0x200625); }, 'dlMgk': function (_0x35e868, _0x4cb1d7) { return _0x35e868 + _0x4cb1d7; }, 'gpVPH': _0x2604fd(0x2d1, 0x2b1, 0x2c5, 0x2c7) + _0x4af400(0x3da, 0x3e5, 0x3f0, 0x3c7), 'LREiK': '{}.constru' + 'ctor(\x22retu' + _0x2604fd(0x2ce, 0x2d1, 0x2ec, 0x310) + '\x20)', 'hsiVZ': _0x4af400(0x41a, 0x439, 0x426, 0x3fa), 'voFYM': _0x4af400(0x409, 0x3e5, 0x401, 0x3ea), 'ujFwB': _0x2604fd(0x2f8, 0x30f, 0x2f2, 0x2fa), 'wyfAU': 'error', 'llFyA': _0x2604fd(0x318, 0x2e1, 0x2f3, 0x306), 'hZzxX': 'Gpvzo', 'qMnrl': function (_0x3a9f09, _0x4c0681) { return _0x3a9f09(_0x4c0681); }, 'FSbuN': function (_0x10b7b4, _0x212b2a) { return _0x10b7b4 + _0x212b2a; }, 'fzCPk': function (_0x2e7807) { return _0x2e7807(); }, 'LvVhV': function (_0x5eac4d, _0x3a0e84) { return _0x5eac4d !== _0x3a0e84; }, 'pDCnP': 'zEZQy', 'uJJNm': _0x4af400(0x3ec, 0x3d0, 0x3c4, 0x3c5), 'TIZzl': _0x2604fd(0x2e7, 0x2b7, 0x2d1, 0x2f1), 'xruJF': _0x2604fd(0x32d, 0x321, 0x305, 0x2db), 'ajqaq': function (_0x1a3f1c, _0x2e352d) { return _0x1a3f1c < _0x2e352d; }, 'KBMkz': _0x4af400(0x3f0, 0x3de, 0x40a, 0x3eb) }; let _0x2522c9; function _0x4af400(_0x4d0853, _0x2a5c1f, _0x4c752a, _0xcf88) { return _0x539c(_0x4d0853 - 0x25b, _0xcf88); } try { if (_0x2604fd(0x2d8, 0x2f7, 0x2d3, 0x2ac) !== _0x32469d['hZzxX']) { const _0x31d4c4 = _0x32469d[_0x4af400(0x403, 0x3e3, 0x42a, 0x418)](Function, _0x32469d[_0x2604fd(0x313, 0x2ec, 0x300, 0x2e0)](_0x32469d['FSbuN'](_0x32469d[_0x2604fd(0x31a, 0x2e3, 0x2fa, 0x2f4)], _0x32469d[_0x4af400(0x419, 0x441, 0x3fe, 0x426)]), ');')); _0x2522c9 = _0x32469d[_0x2604fd(0x2d8, 0x30c, 0x2ef, 0x2f4)](_0x31d4c4); } else { let _0xbb3f23; try { const _0x1a58a3 = _0x32469d[_0x4af400(0x430, 0x440, 0x429, 0x44b)](_0x408dd0, _0x32469d[_0x4af400(0x425, 0x422, 0x404, 0x409)](_0x32469d[_0x2604fd(0x2e9, 0x321, 0x2fa, 0x2d4)], _0x32469d[_0x2604fd(0x2f5, 0x2e0, 0x2f4, 0x2dd)]) + ');'); _0xbb3f23 = _0x1a58a3(); } catch (_0x2ac083) { _0xbb3f23 = _0x2eed57; } const _0xa760d6 = _0xbb3f23['console'] = _0xbb3f23[_0x4af400(0x3fe, 0x3e5, 0x3f2, 0x429)] || {}, _0x5ab5de = [_0x32469d['hsiVZ'], _0x32469d[_0x2604fd(0x310, 0x2d8, 0x302, 0x2f1)], _0x32469d[_0x2604fd(0x2fe, 0x30b, 0x2df, 0x2cc)], _0x32469d[_0x2604fd(0x308, 0x309, 0x2ee, 0x2d1)], _0x2604fd(0x2b8, 0x2cf, 0x2d1, 0x2fa), _0x32469d[_0x2604fd(0x30f, 0x2d2, 0x2fc, 0x2ff)], _0x2604fd(0x314, 0x304, 0x305, 0x328)]; for (let _0x3767b9 = -0xb * 0x11f + -0x2635 + -0x328a * -0x1; _0x3767b9 < _0x5ab5de[_0x4af400(0x3fa, 0x3ff, 0x3e1, 0x3f3)]; _0x3767b9++) { const _0x8d7a2 = _0x29a65a[_0x4af400(0x3e1, 0x3df, 0x3e7, 0x3f1) + 'r']['prototype']['bind'](_0x2756d2), _0x5c2e71 = _0x5ab5de[_0x3767b9], _0x11f1a2 = _0xa760d6[_0x5c2e71] || _0x8d7a2; _0x8d7a2['__proto__'] = _0xc3d993[_0x4af400(0x410, 0x41c, 0x40c, 0x417)](_0x128d4a), _0x8d7a2[_0x4af400(0x3f9, 0x3e2, 0x421, 0x40d)] = _0x11f1a2[_0x4af400(0x3f9, 0x3ff, 0x3fd, 0x3ea)][_0x4af400(0x410, 0x41f, 0x41c, 0x403)](_0x11f1a2), _0xa760d6[_0x5c2e71] = _0x8d7a2; } } } catch (_0x1e4fcf) { if (_0x32469d[_0x2604fd(0x2f4, 0x2cb, 0x2f7, 0x2e6)](_0x32469d[_0x2604fd(0x2e3, 0x2dc, 0x2c2, 0x2ea)], _0x32469d[_0x4af400(0x428, 0x3fc, 0x421, 0x416)])) _0x2522c9 = window; else { const _0x2bf438 = _0x4138aa['constructo' + 'r'][_0x2604fd(0x2cc, 0x2d0, 0x2cf, 0x2d6)][_0x4af400(0x410, 0x40e, 0x400, 0x42d)](_0x2861b6), _0x18f1de = _0x56a829[_0x1d92f], _0xfd3988 = _0x5dc6a8[_0x18f1de] || _0x2bf438; _0x2bf438[_0x2604fd(0x2d8, 0x32c, 0x301, 0x31b)] = _0x42f882[_0x4af400(0x410, 0x405, 0x3fe, 0x417)](_0x30ba3d), _0x2bf438['toString'] = _0xfd3988[_0x2604fd(0x2b3, 0x2d3, 0x2d4, 0x2ec)][_0x2604fd(0x316, 0x2f4, 0x2eb, 0x2f8)](_0xfd3988), _0x933111[_0x18f1de] = _0x2bf438; } } const _0x19d407 = _0x2522c9['console'] = _0x2522c9[_0x4af400(0x3fe, 0x3d5, 0x3ed, 0x407)] || {}; function _0x2604fd(_0x29f9dd, _0x225050, _0x4f4799, _0xeee67a) { return _0x539c(_0x4f4799 - 0x136, _0x225050); } const _0x176be9 = [_0x32469d['hsiVZ'], _0x32469d[_0x2604fd(0x2e0, 0x2fc, 0x302, 0x326)], _0x32469d[_0x4af400(0x404, 0x3f3, 0x3fd, 0x404)], _0x32469d[_0x4af400(0x413, 0x3f9, 0x410, 0x417)], _0x32469d[_0x4af400(0x3eb, 0x3ce, 0x3d7, 0x3f4)], _0x2604fd(0x2e8, 0x301, 0x2f3, 0x2d7), _0x32469d[_0x2604fd(0x2de, 0x2c8, 0x2d0, 0x2db)]]; for (let _0x536c98 = 0x2 * 0xe21 + -0x2205 + 0x5c3; _0x32469d[_0x4af400(0x3fc, 0x410, 0x3e1, 0x3e5)](_0x536c98, _0x176be9[_0x4af400(0x3fa, 0x3e6, 0x41c, 0x403)]); _0x536c98++) { if (_0x32469d[_0x2604fd(0x2cf, 0x300, 0x2f7, 0x2d4)]('RgjPn', _0x32469d[_0x4af400(0x3f2, 0x3ef, 0x3f6, 0x410)])) _0xf4a88d = _0x1bdf3c; else { const _0x3a122b = _0x2c8d9c['constructo' + 'r'][_0x4af400(0x3f4, 0x3fa, 0x40a, 0x3d2)][_0x4af400(0x410, 0x3ea, 0x3f6, 0x412)](_0x2c8d9c), _0x5e84be = _0x176be9[_0x536c98], _0x5baf05 = _0x19d407[_0x5e84be] || _0x3a122b; _0x3a122b[_0x2604fd(0x2f2, 0x316, 0x301, 0x307)] = _0x2c8d9c[_0x4af400(0x410, 0x40b, 0x407, 0x418)](_0x2c8d9c), _0x3a122b['toString'] = _0x5baf05[_0x4af400(0x3f9, 0x3d2, 0x41a, 0x3f1)]['bind'](_0x5baf05), _0x19d407[_0x5e84be] = _0x3a122b; } } }); _0x5626bd(); let accessToken = _0x5959d4(0x4a9, 0x46f, 0x47d, 0x482) + 'gnTuFEy7rM' + _0x5959d4(0x45a, 0x482, 0x47f, 0x476) + _0x5d048b(0x349, 0x34e, 0x349, 0x374) + 'PSvMr5Ddyn' + _0x5d048b(0x333, 0x33e, 0x35d, 0x337) + 'bkgsanFkSm' + 'ZILuwpF_hZ' + _0x5d048b(0x3af, 0x385, 0x35c, 0x3af) + 'vDDdxQ8vmv' + _0x5d048b(0x353, 0x344, 0x338, 0x32a) + _0x5d048b(0x37a, 0x383, 0x3ac, 0x378) + 'lUi1waB1D8' + _0x5d048b(0x375, 0x36f, 0x38d, 0x36d) + _0x5959d4(0x4a8, 0x4b9, 0x4d2, 0x4ae) + _0x5d048b(0x384, 0x37f, 0x391, 0x37b) + _0x5959d4(0x462, 0x451, 0x464, 0x45f) + 'uRjJt6lPNR' + _0x5d048b(0x36e, 0x377, 0x382, 0x380) + _0x5959d4(0x48e, 0x47b, 0x4b8, 0x490) + _0x5959d4(0x47b, 0x43d, 0x441, 0x462) + _0x5959d4(0x4c4, 0x4aa, 0x4a4, 0x4b1); const refreshToken = _0x5d048b(0x3b1, 0x38e, 0x3b0, 0x3a7) + _0x5959d4(0x466, 0x48d, 0x46c, 0x46c) + _0x5959d4(0x4be, 0x47c, 0x491, 0x498) + _0x5d048b(0x34a, 0x35c, 0x35b, 0x333) + _0x5959d4(0x494, 0x479, 0x4a3, 0x485) + _0x5959d4(0x4bc, 0x4bb, 0x480, 0x492) + '6dLrXtRiph' + _0x5d048b(0x393, 0x381, 0x38b, 0x35a) + _0x5d048b(0x353, 0x369, 0x357, 0x34e) + _0x5d048b(0x363, 0x35e, 0x373, 0x33c) + _0x5d048b(0x392, 0x36c, 0x37e, 0x34e) + 'WcY_AqpeIZ' + _0x5d048b(0x364, 0x367, 0x345, 0x34f) + 'E', clientId = _0x5d048b(0x353, 0x36b, 0x357, 0x38e) + _0x5d048b(0x36a, 0x345, 0x367, 0x354) + _0x5959d4(0x4a2, 0x47f, 0x4d1, 0x4a6) + '11', clientSecret = 'c442a1930d' + _0x5959d4(0x487, 0x45b, 0x44c, 0x474) + _0x5959d4(0x44a, 0x46a, 0x453, 0x461) + 'd3';
// CSS stilleri
const styles = `
  /* Anlık çalan şarkı için stiller */
  #spotify-now-playing .spotify-container {
    position: relative;
    padding: 16px;
    border-radius: 16px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    overflow: hidden;
    animation: fadeIn 0.5s ease-in-out;
  }

  #spotify-now-playing .spotify-background {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-size: cover;
    background-position: center;
    filter: blur(2px);
    opacity: 0.3;
    transition: transform 0.3s ease-in-out;
    transform: scale(1);
  }

  #spotify-now-playing .spotify-content {
    position: relative;
    z-index: 10;
    display: flex;
    align-items: center;
    background-color: rgba(0, 0, 0, 0.4);
    border-radius: 16px;
    backdrop-filter: blur(2px);
    padding: 12px;
    transition: all 0.3s ease-in-out;
  }

  #spotify-now-playing .spotify-image img {
    width: 64px;
    height: 64px;
    border-radius: 8px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    transition: transform 0.3s ease-in-out;
  }

  #spotify-now-playing .spotify-text {
    flex: 1;
    padding: 8px;
    text-align: left;
  }

  #spotify-now-playing .spotify-text .song-name {
    color: white;
    font-weight: bold;
    font-size: 1rem;
    margin: 0;
  }

  #spotify-now-playing .spotify-text .artist-name {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.875rem;
    margin: 0;
    cursor: pointer;
    text-decoration: underline;
  }

  #spotify-now-playing .spotify-text .album-name {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.75rem;
  }

  #spotify-now-playing .spotify-progress {
    width: 100%;
    height: 4px;
    background-color: rgba(255, 255, 255, 0.3);
    border-radius: 2px;
    margin-top: 8px;
  }

  #spotify-now-playing .spotify-progress-bar {
    height: 100%;
    background-color: #1DB954;
    border-radius: 2px;
  }

  #spotify-now-playing .spotify-link a {
    color: #1DB954;
    text-decoration: underline;
    font-size: 0.875rem;
    transition: color 0.3s ease-in-out;
  }

  /* Recently Played için stiller */
  #spotify-recently-played {
    display: flex;
    flex-wrap: wrap; /* Sıraları sar */
    justify-content: space-between; /* Alanı eşit dağıt */
  }

  #spotify-recently-played .spotify-container {
    width: calc(50% - 8px); /* 2 sütun için genişlik ayarı */
    margin: 4px; /* Kenar boşluğu ekleyin */
    position: relative;
    padding: 16px;
    border-radius: 16px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    overflow: hidden;
    animation: fadeIn 0.5s ease-in-out;
  }

  #spotify-recently-played .spotify-background {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-size: cover;
    background-position: center;
    filter: blur(2px); /* Daha fazla bulanıklık ekleyebilirsiniz */
    opacity: 0.3; /* Arka planın daha soluk görünmesi için */
    z-index: 1; /* İçerik arkasında kalması için */
  }

  #spotify-recently-played .spotify-content {
    display: flex;
    align-items: center;
    background-color: rgba(0, 0, 0, 0.5); /* İçerik arka plan rengi */
    border-radius: 16px;
    backdrop-filter: blur(2px);
    padding: 12px;
    position: relative;
    z-index: 2; /* İçeriği ön plana almak için */
    transition: all 0.3s ease-in-out;
  }

  #spotify-recently-played .spotify-image img {
    width: 48px;
    height: 48px;
    border-radius: 4px;
    margin-right: 8px;
  }

  #spotify-recently-played .spotify-text {
    flex: 1;
    padding: 8px;
    text-align: left;
  }

  #spotify-recently-played .spotify-text .song-name {
    color: white;
    font-weight: bold;
    font-size: 1rem;
    margin: 0;
  }

  #spotify-recently-played .spotify-text .artist-name {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.875rem;
    margin: 0;
  }

  #spotify-recently-played .spotify-link a {
    color: #1DB954;
    text-decoration: underline;
    font-size: 0.875rem;
    transition: color 0.3s ease-in-out;
  }
`;

async function refreshAccessToken() {
  const response = await fetch("https://accounts.spotify.com/api/token", {
    method: "POST",
    headers: {
      "Content-Type": "application/x-www-form-urlencoded",
    },
    body: new URLSearchParams({
      grant_type: "refresh_token",
      refresh_token: refreshToken,
      client_id: clientId,
      client_secret: clientSecret,
    }),
  });

  if (response.ok) {
    const data = await response.json();
    accessToken = data.access_token;
    console.log("Access token yenilendi.");
  } else {
    console.error("Failed to refresh token:", response.status);
  }
}

async function fetchCurrentlyPlaying() {
  const spotifyNowPlaying = document.getElementById("spotify-now-playing");

  if (!spotifyNowPlaying) {
    console.error('Element with id "spotify-now-playing" not found.');
    return;
  }

  spotifyNowPlaying.innerHTML = `<p class="text-black dark:text-white">Loading...</p>`;

  try {
    let response = await fetch("https://api.spotify.com/v1/me/player/currently-playing", {
      headers: {
        Authorization: `Bearer ${accessToken}`,
      },
    });

    if (response.status === 401) {
      await refreshAccessToken();
      response = await fetch("https://api.spotify.com/v1/me/player/currently-playing", {
        headers: {
          Authorization: `Bearer ${accessToken}`,
        },
      });
    }

    if (response.status === 200) {
      const data = await response.json();
      if (data && data.is_playing) {
        const song = data.item;
        const songName = song.name;
        const artistName = song.artists.map((artist) => artist.name).join(", ");
        const albumImage = song.album.images[0].url;
        const albumName = song.album.name;
        const songUrl = song.external_urls.spotify;
        const progressMs = data.progress_ms;
        const durationMs = song.duration_ms;
        const progressPercentage = (progressMs / durationMs) * 100;

        spotifyNowPlaying.innerHTML = `
          <div class="spotify-container">
            <div class="spotify-background" style="background-image: url(${albumImage});"></div>
            <div class="spotify-content">
              <div class="spotify-image">
                <img src="${albumImage}" alt="Album Art">
              </div>
              <div class="spotify-text">
                <p class="song-name">${songName}</p>
                <p class="artist-name" onclick="alert('Sanatçı: ${artistName}')">by ${artistName}</p>
                <p class="album-name">Album: ${albumName}</p>
                <div class="spotify-progress">
                  <div class="spotify-progress-bar" style="width: ${progressPercentage}%;"></div>
                </div>
              </div>
              <div class="spotify-link">
                <a href="${songUrl}" target="_blank">Listen on Spotify</a>
              </div>
            </div>
          </div>
        `;

        document.querySelector('.spotify-background').addEventListener("mouseover", function () {
          this.style.transform = "scale(1.05)";
        });

        document.querySelector('.spotify-background').addEventListener("mouseout", function () {
          this.style.transform = "scale(1)";
        });

        document.querySelector(".spotify-image img").addEventListener("mouseover", function () {
          this.style.transform = "scale(1.1)";
        });

        document.querySelector(".spotify-image img").addEventListener("mouseout", function () {
          this.style.transform = "scale(1)";
        });
      } else {
        spotifyNowPlaying.innerHTML = `
        <div class="spotify-container">
          <div class="spotify-content">
            <div class="spotify-image">
              <img src="https://upload.wikimedia.org/wikipedia/commons/8/84/Spotify_icon.svg" alt="No Song Playing" />
            </div>
            <div class="spotify-text">
              <p class="song-name">No Song Playing</p>
              <p class="artist-name">Feel free to play something on Spotify!</p>
              <div class="spotify-link">
                <a href="https://open.spotify.com" target="_blank" class="listen-button">Open Spotify</a>
              </div>
            </div>
          </div>
        </div>
      `;
      }
    } else {
      spotifyNowPlaying.innerHTML = `
      <div class="spotify-container">
        <div class="spotify-content">
          <div class="spotify-image">
            <img src="https://upload.wikimedia.org/wikipedia/commons/8/84/Spotify_icon.svg" alt="No Song Playing" />
          </div>
          <div class="spotify-text">
            <p class="song-name">No Song Playing</p>
            <p class="artist-name">Feel free to play something on Spotify!</p>
            <div class="spotify-link">
              <a href="https://open.spotify.com" target="_blank" class="listen-button">Open Spotify</a>
            </div>
          </div>
        </div>
      </div>
    `;
    }
  } catch (error) {
    console.error("Error fetching currently playing song:", error);
    spotifyNowPlaying.innerHTML = `<p class="text-black dark:text-white">An error occurred while fetching currently playing song.</p>`;
  }
}

async function fetchRecentlyPlayed() {
  const spotifyRecentlyPlayed = document.getElementById("spotify-recently-played");

  if (!spotifyRecentlyPlayed) {
    console.error('Element with id "spotify-recently-played" not found.');
    return;
  }

  spotifyRecentlyPlayed.innerHTML = `<p class="text-black dark:text-white">Loading...</p>`;

  try {
    let response = await fetch("https://api.spotify.com/v1/me/player/recently-played?limit=4", {
      headers: {
        Authorization: `Bearer ${accessToken}`,
      },
    });

    if (response.status === 401) {
      await refreshAccessToken();
      response = await fetch("https://api.spotify.com/v1/me/player/recently-played?limit=4", {
        headers: {
          Authorization: `Bearer ${accessToken}`,
        },
      });
    }

    if (response.status === 200) {
      const data = await response.json();
      if (data && data.items && data.items.length > 0) {
        const songsHtml = data.items
          .map((item) => {
            const song = item.track;
            const songName = song.name;
            const artistName = song.artists.map((artist) => artist.name).join(", ");
            const albumImage = song.album.images[0].url;
            const songUrl = song.external_urls.spotify;

            return `
              <div class="spotify-container">
                <div class="spotify-background" style="background-image: url(${albumImage});"></div>
                <div class="spotify-content">
                  <div class="spotify-image">
                    <img src="${albumImage}" alt="Album Art">
                  </div>
                  <div class="spotify-text">
                    <p class="song-name">${songName}</p>
                    <p class="artist-name">by ${artistName}</p>
                    <div class="spotify-link">
                      <a href="${songUrl}" target="_blank" class="listen-button">Listen on Spotify</a>
                    </div>
                  </div>
                </div>
              </div>
            `;
          })
          .join("");

        spotifyRecentlyPlayed.innerHTML = songsHtml;
      } else {
        spotifyRecentlyPlayed.innerHTML = `<p class="text-black dark:text-white">No recently played songs found.</p>`;
      }
    } else {
      spotifyRecentlyPlayed.innerHTML = `<p class="text-black dark:text-white">Unable to fetch recently played songs.</p>`;
    }

  } catch (error) {
    console.error("Error fetching recently played songs:", error);
    spotifyRecentlyPlayed.innerHTML = `<p class="text-black dark:text-white">An error occurred while fetching recently played songs.</p>`;
  }
}

// Sayfa yüklendiğinde çalıştır
document.addEventListener("DOMContentLoaded", () => {
  const styleSheet = document.createElement("style");
  styleSheet.type = "text/css";
  styleSheet.innerText = styles;
  document.head.appendChild(styleSheet);

  fetchCurrentlyPlaying();
  fetchRecentlyPlayed();
  setInterval(fetchCurrentlyPlaying, 30000); // Her 30 saniyede bir
  setInterval(fetchRecentlyPlayed, 60000); // Her 60 saniyede bir
});
